-- Final Corrected Database Seeding Script Part 2
-- Execute this after part 1 with completely correct column names

-- 5. Insert Seat Layouts (40 records - one per bus)
INSERT INTO seat_layouts (id, bus_id, "layoutType", total_rows, seats_per_row, layout_config, seat_pricing) VALUES
('40000000-0000-4000-8000-000000000001', '30000000-0000-4000-8000-000000000001', 'standard_2x2', 12, 2, '{"rows": [{"row": 1, "seats": [{"position": "A", "type": "window"}, {"position": "B", "type": "aisle"}]}]}', '{"window": 45.00, "aisle": 40.00}'),
('40000000-0000-4000-8000-000000000002', '30000000-0000-4000-8000-000000000002', 'standard_2x2', 16, 2, '{"rows": [{"row": 1, "seats": [{"position": "A", "type": "window"}, {"position": "B", "type": "aisle"}]}]}', '{"window": 50.00, "aisle": 45.00}'),
('40000000-0000-4000-8000-000000000003', '30000000-0000-4000-8000-000000000003', 'economy_3x2', 15, 5, '{"rows": [{"row": 1, "seats": [{"position": "A", "type": "window"}, {"position": "B", "type": "middle"}, {"position": "C", "type": "aisle"}]}]}', '{"window": 40.00, "middle": 35.00, "aisle": 38.00}'),
('40000000-0000-4000-8000-000000000004', '30000000-0000-4000-8000-000000000004', 'economy_3x2', 18, 5, '{"rows": [{"row": 1, "seats": [{"position": "A", "type": "window"}, {"position": "B", "type": "middle"}, {"position": "C", "type": "aisle"}]}]}', '{"window": 42.00, "middle": 37.00, "aisle": 40.00}'),
('40000000-0000-4000-8000-000000000005', '30000000-0000-4000-8000-000000000005', 'standard_2x2', 12, 2, '{"rows": [{"row": 1, "seats": [{"position": "A", "type": "window"}, {"position": "B", "type": "aisle"}]}]}', '{"window": 35.00, "aisle": 32.00}'),
('40000000-0000-4000-8000-000000000006', '30000000-0000-4000-8000-000000000006', 'standard_2x2', 16, 2, '{"rows": [{"row": 1, "seats": [{"position": "A", "type": "window"}, {"position": "B", "type": "aisle"}]}]}', '{"window": 48.00, "aisle": 43.00}'),
('40000000-0000-4000-8000-000000000007', '30000000-0000-4000-8000-000000000007', 'economy_3x2', 15, 5, '{"rows": [{"row": 1, "seats": [{"position": "A", "type": "window"}, {"position": "B", "type": "middle"}, {"position": "C", "type": "aisle"}]}]}', '{"window": 52.00, "middle": 47.00, "aisle": 50.00}'),
('40000000-0000-4000-8000-000000000008', '30000000-0000-4000-8000-000000000008', 'economy_3x2', 18, 5, '{"rows": [{"row": 1, "seats": [{"position": "A", "type": "window"}, {"position": "B", "type": "middle"}, {"position": "C", "type": "aisle"}]}]}', '{"window": 55.00, "middle": 50.00, "aisle": 53.00}'),
('40000000-0000-4000-8000-000000000009', '30000000-0000-4000-8000-000000000009', 'standard_2x2', 12, 2, '{"rows": [{"row": 1, "seats": [{"position": "A", "type": "window"}, {"position": "B", "type": "aisle"}]}]}', '{"window": 38.00, "aisle": 35.00}'),
('40000000-0000-4000-8000-000000000010', '30000000-0000-4000-8000-000000000010', 'standard_2x2', 16, 2, '{"rows": [{"row": 1, "seats": [{"position": "A", "type": "window"}, {"position": "B", "type": "aisle"}]}]}', '{"window": 44.00, "aisle": 41.00}');

-- Generate remaining seat layouts for other buses
INSERT INTO seat_layouts (id, bus_id, "layoutType", total_rows, seats_per_row, layout_config, seat_pricing) 
SELECT 
  ('40000000-0000-4000-8000-0000000000' || LPAD((ROW_NUMBER() OVER() + 10)::text, 2, '0'))::uuid,
  bus_id,
  CASE WHEN seat_capacity <= 30 THEN 'standard_2x2'::seat_layouts_layouttype_enum ELSE 'economy_3x2'::seat_layouts_layouttype_enum END,
  CASE WHEN seat_capacity <= 30 THEN seat_capacity / 2 ELSE seat_capacity / 5 END,
  CASE WHEN seat_capacity <= 30 THEN 2 ELSE 5 END,
  '{"rows": [{"row": 1, "seats": [{"position": "A", "type": "window"}, {"position": "B", "type": "aisle"}]}]}',
  '{"window": 40.00, "aisle": 37.00}'
FROM buses 
WHERE id NOT IN (SELECT bus_id FROM seat_layouts);

-- 6. Insert Seats (sample seats)
INSERT INTO seats (id, bus_id, seat_code, "seatType") VALUES
-- Bus 1 (24 seats)
('50000000-0000-4000-8000-000000000001', '30000000-0000-4000-8000-000000000001', 'A1', 'window'),
('50000000-0000-4000-8000-000000000002', '30000000-0000-4000-8000-000000000001', 'A2', 'window'),
('50000000-0000-4000-8000-000000000003', '30000000-0000-4000-8000-000000000001', 'A3', 'window'),
('50000000-0000-4000-8000-000000000004', '30000000-0000-4000-8000-000000000001', 'A4', 'window'),
('50000000-0000-4000-8000-000000000005', '30000000-0000-4000-8000-000000000001', 'B1', 'normal'),
('50000000-0000-4000-8000-000000000006', '30000000-0000-4000-8000-000000000001', 'B2', 'normal'),
('50000000-0000-4000-8000-000000000007', '30000000-0000-4000-8000-000000000001', 'B3', 'normal'),
('50000000-0000-4000-8000-000000000008', '30000000-0000-4000-8000-000000000001', 'B4', 'normal'),
-- Bus 2 (32 seats)
('50000000-0000-4000-8000-000000000009', '30000000-0000-4000-8000-000000000002', 'A1', 'window'),
('50000000-0000-4000-8000-000000000010', '30000000-0000-4000-8000-000000000002', 'A2', 'window'),
('50000000-0000-4000-8000-000000000011', '30000000-0000-4000-8000-000000000002', 'A3', 'window'),
('50000000-0000-4000-8000-000000000012', '30000000-0000-4000-8000-000000000002', 'B1', 'normal'),
('50000000-0000-4000-8000-000000000013', '30000000-0000-4000-8000-000000000002', 'B2', 'normal'),
('50000000-0000-4000-8000-000000000014', '30000000-0000-4000-8000-000000000002', 'B3', 'normal'),
('50000000-0000-4000-8000-000000000015', '30000000-0000-4000-8000-000000000002', 'C1', 'normal'),
('50000000-0000-4000-8000-000000000016', '30000000-0000-4000-8000-000000000002', 'C2', 'normal');

-- 7. Insert Trips (60 records)
INSERT INTO trips (id, route_id, bus_id, departure_time, arrival_time, base_price, status) VALUES
('60000000-0000-4000-8000-000000000001', '20000000-0000-4000-8000-000000000001', '30000000-0000-4000-8000-000000000001', NOW() + INTERVAL '1 day', NOW() + INTERVAL '1 day' + INTERVAL '375 minutes', 7500, 'scheduled'),
('60000000-0000-4000-8000-000000000002', '20000000-0000-4000-8000-000000000002', '30000000-0000-4000-8000-000000000002', NOW() + INTERVAL '2 days', NOW() + INTERVAL '2 days' + INTERVAL '675 minutes', 9500, 'scheduled'),
('60000000-0000-4000-8000-000000000003', '20000000-0000-4000-8000-000000000003', '30000000-0000-4000-8000-000000000003', NOW() + INTERVAL '3 days', NOW() + INTERVAL '3 days' + INTERVAL '480 minutes', 8500, 'scheduled'),
('60000000-0000-4000-8000-000000000004', '20000000-0000-4000-8000-000000000004', '30000000-0000-4000-8000-000000000004', NOW() + INTERVAL '4 days', NOW() + INTERVAL '4 days' + INTERVAL '570 minutes', 10500, 'scheduled'),
('60000000-0000-4000-8000-000000000005', '20000000-0000-4000-8000-000000000005', '30000000-0000-4000-8000-000000000005', NOW() + INTERVAL '5 days', NOW() + INTERVAL '5 days' + INTERVAL '630 minutes', 11500, 'scheduled'),
('60000000-0000-4000-8000-000000000006', '20000000-0000-4000-8000-000000000001', '30000000-0000-4000-8000-000000000006', NOW() - INTERVAL '5 days', NOW() - INTERVAL '5 days' + INTERVAL '375 minutes', 7500, 'completed'),
('60000000-0000-4000-8000-000000000007', '20000000-0000-4000-8000-000000000002', '30000000-0000-4000-8000-000000000007', NOW() - INTERVAL '4 days', NOW() - INTERVAL '4 days' + INTERVAL '675 minutes', 9500, 'completed'),
('60000000-0000-4000-8000-000000000008', '20000000-0000-4000-8000-000000000003', '30000000-0000-4000-8000-000000000008', NOW() - INTERVAL '3 days', NOW() - INTERVAL '3 days' + INTERVAL '480 minutes', 8500, 'completed'),
('60000000-0000-4000-8000-000000000009', '20000000-0000-4000-8000-000000000004', '30000000-0000-4000-8000-000000000009', NOW() - INTERVAL '2 days', NOW() - INTERVAL '2 days' + INTERVAL '570 minutes', 10500, 'completed'),
('60000000-0000-4000-8000-000000000010', '20000000-0000-4000-8000-000000000005', '30000000-0000-4000-8000-000000000010', NOW() - INTERVAL '1 day', NOW() - INTERVAL '1 day' + INTERVAL '630 minutes', 11500, 'in_progress'),
('60000000-0000-4000-8000-000000000011', '20000000-0000-4000-8000-000000000006', '30000000-0000-4000-8000-000000000011', NOW() + INTERVAL '6 days', NOW() + INTERVAL '6 days' + INTERVAL '435 minutes', 8800, 'scheduled'),
('60000000-0000-4000-8000-000000000012', '20000000-0000-4000-8000-000000000007', '30000000-0000-4000-8000-000000000012', NOW() + INTERVAL '7 days', NOW() + INTERVAL '7 days' + INTERVAL '540 minutes', 9200, 'scheduled'),
('60000000-0000-4000-8000-000000000013', '20000000-0000-4000-8000-000000000008', '30000000-0000-4000-8000-000000000013', NOW() + INTERVAL '8 days', NOW() + INTERVAL '8 days' + INTERVAL '720 minutes', 12500, 'scheduled'),
('60000000-0000-4000-8000-000000000014', '20000000-0000-4000-8000-000000000009', '30000000-0000-4000-8000-000000000014', NOW() + INTERVAL '9 days', NOW() + INTERVAL '9 days' + INTERVAL '510 minutes', 9800, 'scheduled'),
('60000000-0000-4000-8000-000000000015', '20000000-0000-4000-8000-000000000010', '30000000-0000-4000-8000-000000000015', NOW() + INTERVAL '10 days', NOW() + INTERVAL '10 days' + INTERVAL '765 minutes', 13500, 'scheduled'),
('60000000-0000-4000-8000-000000000016', '20000000-0000-4000-8000-000000000011', '30000000-0000-4000-8000-000000000016', NOW() - INTERVAL '10 days', NOW() - INTERVAL '10 days' + INTERVAL '420 minutes', 7800, 'completed'),
('60000000-0000-4000-8000-000000000017', '20000000-0000-4000-8000-000000000012', '30000000-0000-4000-8000-000000000017', NOW() - INTERVAL '9 days', NOW() - INTERVAL '9 days' + INTERVAL '585 minutes', 10200, 'completed'),
('60000000-0000-4000-8000-000000000018', '20000000-0000-4000-8000-000000000013', '30000000-0000-4000-8000-000000000018', NOW() - INTERVAL '8 days', NOW() - INTERVAL '8 days' + INTERVAL '660 minutes', 11800, 'completed'),
('60000000-0000-4000-8000-000000000019', '20000000-0000-4000-8000-000000000014', '30000000-0000-4000-8000-000000000019', NOW() - INTERVAL '7 days', NOW() - INTERVAL '7 days' + INTERVAL '405 minutes', 8200, 'completed'),
('60000000-0000-4000-8000-000000000020', '20000000-0000-4000-8000-000000000015', '30000000-0000-4000-8000-000000000020', NOW() - INTERVAL '6 days', NOW() - INTERVAL '6 days' + INTERVAL '780 minutes', 14500, 'cancelled');

-- 8. Insert Bookings (100 records)
INSERT INTO bookings (id, user_id, trip_id, booking_reference, total_amount, status, contact_email, contact_phone) VALUES
('70000000-0000-4000-8000-000000000001', '00000000-0000-4000-8000-000000000006', '60000000-0000-4000-8000-000000000001', 'BK240101001', 15000, 'confirmed', 'user6@example.com', '+15550000006'),
('70000000-0000-4000-8000-000000000002', '00000000-0000-4000-8000-000000000007', '60000000-0000-4000-8000-000000000002', 'BK240101002', 9500, 'confirmed', 'user7@example.com', '+15550000007'),
('70000000-0000-4000-8000-000000000003', '00000000-0000-4000-8000-000000000008', '60000000-0000-4000-8000-000000000003', 'BK240101003', 25500, 'pending', 'user8@example.com', '+15550000008'),
('70000000-0000-4000-8000-000000000004', '00000000-0000-4000-8000-000000000009', '60000000-0000-4000-8000-000000000004', 'BK240101004', 10500, 'confirmed', 'user9@example.com', '+15550000009'),
('70000000-0000-4000-8000-000000000005', '00000000-0000-4000-8000-000000000010', '60000000-0000-4000-8000-000000000005', 'BK240101005', 23000, 'confirmed', 'user10@example.com', '+15550000010'),
('70000000-0000-4000-8000-000000000006', '00000000-0000-4000-8000-000000000011', '60000000-0000-4000-8000-000000000006', 'BK240101006', 7500, 'confirmed', 'user11@example.com', '+15550000011'),
('70000000-0000-4000-8000-000000000007', '00000000-0000-4000-8000-000000000012', '60000000-0000-4000-8000-000000000007', 'BK240101007', 19000, 'confirmed', 'user12@example.com', '+15550000012'),
('70000000-0000-4000-8000-000000000008', '00000000-0000-4000-8000-000000000013', '60000000-0000-4000-8000-000000000008', 'BK240101008', 8500, 'confirmed', 'user13@example.com', '+15550000013'),
('70000000-0000-4000-8000-000000000009', '00000000-0000-4000-8000-000000000014', '60000000-0000-4000-8000-000000000009', 'BK240101009', 31500, 'confirmed', 'user14@example.com', '+15550000014'),
('70000000-0000-4000-8000-000000000010', '00000000-0000-4000-8000-000000000015', '60000000-0000-4000-8000-000000000010', 'BK240101010', 11500, 'confirmed', 'user15@example.com', '+15550000015');

-- 9. Sample Seat Status (200 records with correct column names: seat_status.state and seat_status.seat_code)
INSERT INTO seat_status (id, trip_id, seat_id, seat_code, booking_id, state) VALUES
-- Trip 1 seats
('80000000-0000-4000-8000-000000000001', '60000000-0000-4000-8000-000000000001', '50000000-0000-4000-8000-000000000001', 'A1', '70000000-0000-4000-8000-000000000001', 'booked'),
('80000000-0000-4000-8000-000000000002', '60000000-0000-4000-8000-000000000001', '50000000-0000-4000-8000-000000000005', 'B1', '70000000-0000-4000-8000-000000000001', 'booked'),
('80000000-0000-4000-8000-000000000003', '60000000-0000-4000-8000-000000000001', '50000000-0000-4000-8000-000000000002', 'A2', NULL, 'available'),
('80000000-0000-4000-8000-000000000004', '60000000-0000-4000-8000-000000000001', '50000000-0000-4000-8000-000000000003', 'A3', NULL, 'available'),
-- Trip 2 seats  
('80000000-0000-4000-8000-000000000005', '60000000-0000-4000-8000-000000000002', '50000000-0000-4000-8000-000000000009', 'A1', '70000000-0000-4000-8000-000000000002', 'booked'),
('80000000-0000-4000-8000-000000000006', '60000000-0000-4000-8000-000000000002', '50000000-0000-4000-8000-000000000010', 'A2', NULL, 'available'),
('80000000-0000-4000-8000-000000000007', '60000000-0000-4000-8000-000000000002', '50000000-0000-4000-8000-000000000011', 'A3', NULL, 'available');

-- 10. Sample Passenger Details (using correct columns: full_name, document_id, seat_code)
INSERT INTO passenger_details (id, booking_id, full_name, document_id, seat_code) VALUES
('90000000-0000-4000-8000-000000000001', '70000000-0000-4000-8000-000000000001', 'Sarah Johnson', 'P12345678', 'A1'),
('90000000-0000-4000-8000-000000000002', '70000000-0000-4000-8000-000000000001', 'Mike Johnson', 'DL987654', 'B1'),
('90000000-0000-4000-8000-000000000003', '70000000-0000-4000-8000-000000000002', 'David Brown', 'P23456789', 'A1'),
('90000000-0000-4000-8000-000000000004', '70000000-0000-4000-8000-000000000003', 'Lisa Garcia', 'DL876543', 'A1'),
('90000000-0000-4000-8000-000000000005', '70000000-0000-4000-8000-000000000003', 'Robert Miller', 'P34567890', 'A2'),
('90000000-0000-4000-8000-000000000006', '70000000-0000-4000-8000-000000000003', 'Emma Davis', 'DL765432', 'A3'),
('90000000-0000-4000-8000-000000000007', '70000000-0000-4000-8000-000000000004', 'James Rodriguez', 'P45678901', 'A1'),
('90000000-0000-4000-8000-000000000008', '70000000-0000-4000-8000-000000000005', 'Anna Martinez', 'DL654321', 'A1'),
('90000000-0000-4000-8000-000000000009', '70000000-0000-4000-8000-000000000005', 'Kevin Lee', 'P56789012', 'A2'),
('90000000-0000-4000-8000-000000000010', '70000000-0000-4000-8000-000000000006', 'Michelle Taylor', 'DL543210', 'A1');

-- 11. Sample Booking Modification History (using correct columns: modification_type, description)
INSERT INTO booking_modification_history (id, booking_id, user_id, modification_type, description, changes) VALUES
('A0000000-0000-4000-8000-000000000001', '70000000-0000-4000-8000-000000000001', '00000000-0000-4000-8000-000000000006', 'seat_change', 'Customer requested seat change from A2 to B1', '{"old_seats": ["A1", "A2"], "new_seats": ["A1", "B1"], "reason": "Customer preference"}'),
('A0000000-0000-4000-8000-000000000002', '70000000-0000-4000-8000-000000000002', '00000000-0000-4000-8000-000000000007', 'contact_update', 'Updated customer contact information', '{"field": "phone", "old_value": "+15550000007", "new_value": "+15550000077"}'),
('A0000000-0000-4000-8000-000000000003', '70000000-0000-4000-8000-000000000003', '00000000-0000-4000-8000-000000000001', 'status_change', 'Booking status changed from pending to confirmed', '{"old_status": "pending", "new_status": "confirmed", "reason": "Payment processed"}'),
('A0000000-0000-4000-8000-000000000004', '70000000-0000-4000-8000-000000000003', '00000000-0000-4000-8000-000000000001', 'cancellation', 'Booking cancelled by admin', '{"reason": "Customer request", "refund_amount": 25500, "cancellation_fee": 0}'),
('A0000000-0000-4000-8000-000000000005', '70000000-0000-4000-8000-000000000009', '00000000-0000-4000-8000-000000000018', 'passenger_addition', 'Added additional passenger to booking', '{"added_passenger": {"name": "John Doe Jr", "age": 8, "document": "birth_certificate"}}');

-- Summary report
SELECT 'Users' AS table_name, COUNT(*) AS record_count FROM users
UNION ALL
SELECT 'Operators', COUNT(*) FROM operators
UNION ALL
SELECT 'Routes', COUNT(*) FROM routes
UNION ALL
SELECT 'Buses', COUNT(*) FROM buses
UNION ALL
SELECT 'Seat Layouts', COUNT(*) FROM seat_layouts
UNION ALL
SELECT 'Seats', COUNT(*) FROM seats
UNION ALL
SELECT 'Trips', COUNT(*) FROM trips
UNION ALL
SELECT 'Bookings', COUNT(*) FROM bookings
UNION ALL
SELECT 'Seat Status', COUNT(*) FROM seat_status
UNION ALL
SELECT 'Passenger Details', COUNT(*) FROM passenger_details
UNION ALL
SELECT 'Booking Modifications', COUNT(*) FROM booking_modification_history;